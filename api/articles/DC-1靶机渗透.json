{"title":"DC-1靶机渗透详解","uid":"9ad4b35bee6dc5b3bef9da6cf161cc25","slug":"DC-1靶机渗透","date":"2023-01-03T11:12:52.175Z","updated":"2023-01-03T11:25:04.644Z","comments":true,"path":"api/articles/DC-1靶机渗透.json","keywords":null,"cover":"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typorawallhaven-p2rzop.jpg","content":"<h1 id=\"dc-1靶机渗透过程详解\"><a href=\"#dc-1靶机渗透过程详解\" class=\"headerlink\" title=\"dc-1靶机渗透过程详解\"></a>dc-1靶机渗透过程详解</h1><h2 id=\"一-实验环境\"><a href=\"#一-实验环境\" class=\"headerlink\" title=\"一:实验环境\"></a>一:实验环境</h2><p>kali攻击机:192.168.2.103</p>\n<p>DC-1靶机”192.168.1.128</p>\n<h2 id=\"二-信息收集\"><a href=\"#二-信息收集\" class=\"headerlink\" title=\"二:信息收集\"></a>二:信息收集</h2><h3 id=\"主机发现\"><a href=\"#主机发现\" class=\"headerlink\" title=\"主机发现\"></a>主机发现</h3><p><code>nmap -sP 192.168.1.0/24</code></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103191556712.png\" alt=\"image-20230103191556712\"></p>\n<h3 id=\"端口发现\"><a href=\"#端口发现\" class=\"headerlink\" title=\"端口发现\"></a>端口发现</h3><p><code>masscan --rate=10000 --ports 0-65535 192.168.1.128</code></p>\n<p> <img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103191657177.png\" alt=\"image-20230103191657177\"></p>\n<p>再利用nmap精细扫描端口</p>\n<p><code>nmap -T4 -sV -p22,80,111,38781 -A 192.168.1.128</code></p>\n<p>结果如下</p>\n<p> <img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103191720998.png\" alt=\"image-20230103191720998\"></p>\n<p>可以看到开放了两个重要端口22和80</p>\n<p> <img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103191727800.png\" alt=\"image-20230103191727800\"></p>\n<p>可以看到收集到了80端口的一系列敏感信息</p>\n<p> <img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103191733570.png\" alt=\"image-20230103191733570\"></p>\n<p>网站信息探测</p>\n<p>打开80端口对应的网站</p>\n<p>192.168.1.128:80</p>\n<p> <img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103191753008.png\" alt=\"image-20230103191753008\"></p>\n<p>利用插件找到了网站的cms</p>\n<h2 id=\"三-渗透测试\"><a href=\"#三-渗透测试\" class=\"headerlink\" title=\"三:渗透测试\"></a>三:渗透测试</h2><h3 id=\"漏洞发现\"><a href=\"#漏洞发现\" class=\"headerlink\" title=\"漏洞发现\"></a>漏洞发现</h3><p>已知cms版本，搜索相应漏洞</p>\n<p>在漏洞库中找到对应版本我们可以利用的漏洞</p>\n<p> <img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103191811191.png\" alt=\"image-20230103191811191\"></p>\n<p>利用searchsploit drupal找到kali中保存的漏洞库</p>\n<p> <img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103191819103.png\" alt=\"image-20230103191819103\"></p>\n<p>打开msf</p>\n<p> <img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103191833728.png\" alt=\"image-20230103191833728\"></p>\n<p>搜索drupal漏洞</p>\n<p> <img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103191840734.png\" alt=\"image-20230103191840734\"></p>\n<p>调用漏洞模块</p>\n<p> <img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103191847424.png\" alt=\"image-20230103191847424\"></p>\n<p>利用info查看漏洞信息</p>\n<p> <img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103192006254.png\" alt=\"image-20230103192006254\"></p>\n<h3 id=\"漏洞利用\"><a href=\"#漏洞利用\" class=\"headerlink\" title=\"漏洞利用\"></a>漏洞利用</h3><p>查看选项：<code>show options</code>命令</p>\n<p>指定靶机：<code>set RHOSTS 192.168.1.128</code></p>\n<p> <img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103192012812.png\" alt=\"image-20230103192012812\"></p>\n<p>漏洞利用exploit命令</p>\n<p> <img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103192037856.png\" alt=\"image-20230103192037856\"></p>\n<p>可以看到得到了一个会话</p>\n<p>利用msf远程控制靶机</p>\n<p> <img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103192043419.png\" alt=\"image-20230103192043419\"></p>\n<p>进入交互式shell</p>\n<p><code>python -c ‘import pty;pty.spawn(“/bin/bash”)’</code></p>\n<p> <img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103192121672.png\" alt=\"image-20230103192121672\"></p>\n<p>找到第一个flag</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103192131295.png\" alt=\"image-20230103192131295\"></p>\n<p>根据提示找到第二个flag</p>\n<p> <img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103192137582.png\" alt=\"image-20230103192137582\"></p>\n<p>找cms的配置文件</p>\n<p> <img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103192149219.png\" alt=\"image-20230103192149219\"></p>\n<p>看到配置文件里有数据库的账号和密码，尝试登录数据库</p>\n<p> <img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103192158435.png\" alt=\"image-20230103192158435\"></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103192205801.png\" alt=\"image-20230103192205801\"></p>\n<p>登录成功</p>\n<p>查看user表中的信息</p>\n<p> <img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103192215670.png\" alt=\"image-20230103192215670\"></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103192244159.png\" alt=\"image-20230103192244159\"></p>\n<p>可以看到密码被加密了，通过查阅资料可知密码是通过&#x2F;script&#x2F;password-hash.sh这个脚本进行的加密</p>\n<p>我们通过这个脚本自己修改一个密码</p>\n<p> <img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103192256028.png\" alt=\"image-20230103192256028\"></p>\n<p>在进入mysql数据库更新</p>\n<p> <img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103192302256.png\" alt=\"image-20230103192302256\"></p>\n<p>用我们之前自己设置的密码替换管理员密码</p>\n<p>用修改过的密码成功登录后台</p>\n<p> <img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103192314628.png\" alt=\"image-20230103192314628\"></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103192327505.png\" alt=\"image-20230103192327505\"></p>\n<p>找到flag3</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103192339462.png\" alt=\"image-20230103192339462\"></p>\n<p>通过cat &#x2F;etc&#x2F;passwd查看用户，找到flag4用户</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103192347936.png\" alt=\"image-20230103192347936\"></p>\n<p>尝试用hydra对flag4用户暴力破解</p>\n<p><code>hydra -l flag4 -P /usr/share/wordlists/rockyou.txt ssh://192.168.2.102 </code></p>\n<p> <img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103192408809.png\" alt=\"image-20230103192408809\"></p>\n<p>破解成功</p>\n<p>尝试远程登录</p>\n<p> <img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103192423498.png\" alt=\"image-20230103192423498\"></p>\n<p>找到第四个flag</p>\n<p> <img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103192432498.png\" alt=\"image-20230103192432498\"></p>\n<p>根据之前flag3的提示，我们知道了find这个命令有特殊的权限</p>\n<p> <img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103192441261.png\" alt=\"image-20230103192441261\"></p>\n<p>直接进行提权</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103192449109.png\" alt=\"image-20230103192449109\"></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103192458034.png\" alt=\"image-20230103192458034\"></p>\n<p>获得root权限</p>\n<p> <img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103192503504.png\" alt=\"image-20230103192503504\"></p>\n<p>拿到最后一个flag</p>\n","feature":true,"text":"dc-1靶机渗透过程详解一:实验环境kali攻击机:192.168.2.103 DC-1靶机”192.168.1.128 二:信息收集主机发现nmap -sP 192.168.1.0/24 端口发现masscan --rate=10000 --ports 0-65535 192....","link":"","photos":[],"count_time":{"symbolsCount":"1.1k","symbolsTime":"1 mins."},"categories":[{"name":"学习笔记","slug":"学习笔记","count":16,"path":"api/categories/学习笔记.json"}],"tags":[{"name":"DC系列靶机","slug":"DC系列靶机","count":4,"path":"api/tags/DC系列靶机.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#dc-1%E9%9D%B6%E6%9C%BA%E6%B8%97%E9%80%8F%E8%BF%87%E7%A8%8B%E8%AF%A6%E8%A7%A3\"><span class=\"toc-text\">dc-1靶机渗透过程详解</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%B8%80-%E5%AE%9E%E9%AA%8C%E7%8E%AF%E5%A2%83\"><span class=\"toc-text\">一:实验环境</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%BA%8C-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86\"><span class=\"toc-text\">二:信息收集</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E4%B8%BB%E6%9C%BA%E5%8F%91%E7%8E%B0\"><span class=\"toc-text\">主机发现</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%AB%AF%E5%8F%A3%E5%8F%91%E7%8E%B0\"><span class=\"toc-text\">端口发现</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%B8%89-%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95\"><span class=\"toc-text\">三:渗透测试</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%BC%8F%E6%B4%9E%E5%8F%91%E7%8E%B0\"><span class=\"toc-text\">漏洞发现</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8\"><span class=\"toc-text\">漏洞利用</span></a></li></ol></li></ol></li></ol>","author":{"name":"Abyssaler","slug":"blog-author","avatar":"https://pic.kts.g.mi.com/551ced5839599747048c3c99a9d47df4203311636470612235.jpg","link":"/","description":"道阻且长，行则将至","socials":{"github":"https://github.com/Abyssaler","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/weixin_45349299","juejin":"","customs":{}}},"mapped":true,"prev_post":{},"next_post":{"title":"DC-3靶机渗透详解","uid":"1c7e747eafbee54a34e09632a5e7394e","slug":"DC-3靶机渗透","date":"2023-01-02T02:52:18.139Z","updated":"2023-01-02T09:25:00.764Z","comments":true,"path":"api/articles/DC-3靶机渗透.json","keywords":null,"cover":"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typorawallhaven-dpj35g.jpg","text":"DC-3靶机渗透全流程一:实验环境攻击机:kali2022(192.168.2.103) 靶机:dc-3(192.168.2.102) 二:信息收集主机发现netdiscover -i eth0 -r 192.168.2.0/24 发现目标主机 端口扫描masscan --rat...","link":"","photos":[],"count_time":{"symbolsCount":"3.9k","symbolsTime":"4 mins."},"categories":[{"name":"学习笔记","slug":"学习笔记","count":16,"path":"api/categories/学习笔记.json"}],"tags":[{"name":"DC系列靶机","slug":"DC系列靶机","count":4,"path":"api/tags/DC系列靶机.json"}],"author":{"name":"Abyssaler","slug":"blog-author","avatar":"https://pic.kts.g.mi.com/551ced5839599747048c3c99a9d47df4203311636470612235.jpg","link":"/","description":"道阻且长，行则将至","socials":{"github":"https://github.com/Abyssaler","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/weixin_45349299","juejin":"","customs":{}}},"feature":true}}